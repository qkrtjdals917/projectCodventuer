<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lec.spring.domain.board.BoardDAO">

	<!-- 공지사항 리스트 -->
	<select id="selectNotice" resultType="com.lec.spring.domain.board.BoardDTO">
		SELECT mb.board_uid board_uid, mb.subject subject,
		mm.nickname nickname, mb.regDate regDate, mb.count count
		FROM mc_board mb , mc_member mm
		WHERE mb.member_uid = mm.member_uid
		AND mb.type = "공지"
		ORDER BY board_uid DESC
	</select>
	
	<!-- 글 선택, 보기에서 활용 -->
	<select id="selectOne" resultType="com.lec.spring.domain.board.BoardDTO">
		SELECT mb.board_uid board_uid, mb.subject subject, mm.nickname nickname,
		mb.regDate regDate, mb.count count, mb.content content,
		mb.type type, mb.tag tag
		FROM mc_board mb , mc_member mm
		WHERE mb.member_uid = mm.member_uid
		AND mb.board_uid = #{board_uid}
	</select>
	
	<!-- 조회수 증가 -->
	<update id="viewCnt" flushCache="true">
		UPDATE mc_board SET count = count + 1 WHERE board_uid = #{param0};
	</update>
	
	<!-- 커뮤니티 글 전체 리스트 -->
	<select id="selectCommunity" resultType="com.lec.spring.domain.board.BoardDTO">
		<![CDATA[
			SELECT mb.board_uid board_uid, mb.subject subject, mm.nickname nickname, 
			mb.regDate regDate, mb.count count, mb.content content, 
			mb.type type, mb.tag tag 
			FROM mc_board mb , mc_member mm 
			WHERE mb.member_uid = mm.member_uid
			AND mb.type <> "공지"
			ORDER BY board_uid DESC
		]]>
	</select>	
	
	<!-- 자유 글 리스트 -->
	<select id="selectFree" resultType="com.lec.spring.domain.board.BoardDTO">
		<![CDATA[
			SELECT mb.board_uid board_uid, mb.subject subject, mm.nickname nickname, 
			mb.regDate regDate, mb.count count, mb.content content, 
			mb.type type, mb.tag tag 
			FROM mc_board mb , mc_member mm 
			WHERE mb.member_uid = mm.member_uid
			AND mb.type = "자유"
			ORDER BY board_uid DESC
		]]>
	</select>

	<!-- 정보 글 전체 리스트 -->
	<select id="selectInfo" resultType="com.lec.spring.domain.board.BoardDTO">
		<![CDATA[
			SELECT mb.board_uid board_uid, mb.subject subject, mm.nickname nickname, 
			mb.regDate regDate, mb.count count, mb.content content, 
			mb.type type, mb.tag tag 
			FROM mc_board mb , mc_member mm 
			WHERE mb.member_uid = mm.member_uid
			AND mb.type = "정보"
			ORDER BY board_uid DESC
		]]>
	</select>
	
	<!-- 글작성 로그인 연계-->
	<insert id="insert" flushCache="true" parameterType="com.lec.spring.domain.board.BoardDTO"
	keyProperty="board_uid" keyColumn="board_uid" useGeneratedKeys="true">
		INSERT INTO mc_board (type, subject, tag, content, member_uid)
		VALUES (#{type}, #{subject}, #{tag, jdbcType=VARCHAR}, #{content}, #{member_uid})
	</insert>
	
	
</mapper>